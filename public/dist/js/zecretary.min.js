var zp=function(){"use strict";var t=function(t){zp.model.initModule(),zp.shell.initModule(t)};return{initModule:t}}();zp.model=function(){"use strict";var t,e,n,a,o,i,r,d,l,c,s,u,p,f,h,m,g,y,v,w,k,b={local_db:null,remote_db:null,dbhost:null};return d=function(t){var e=$.Deferred(),n=b.remote_db;return n.login(t.id,t.pw).then(function(){return n.getUser(t.id)}).then(function(t){e.resolve(t),console.log(t)})["catch"](function(t){e.reject(t)}),e.promise()},s=function(){var t=$.Deferred(),n=b.remote_db;return n.logout().then(function(n){t.resolve(n),e(),console.log(n)})["catch"](function(e){t.reject(e)}),t.promise()},c=function(t){var e=b.remote_db,n=$.Deferred();return e.getUser(t).then(function(t){console.log(t),n.reject(t)})["catch"](function(t){console.log(t),n.resolve(t)}),n.promise()},l=function(t){var e=b.remote_db,n=$.Deferred();return e.signup(t.id,t.pw,{metadata:{email:t.email,nick:t.nick,qst:t.qst,ans:t.ans,avatar:t.avatar}}).then(function(t){console.log(t),n.resolve(t)})["catch"](function(t){console.log(t),n.reject(t)}),n.promise()},u=function(t){var e=$.Deferred(),n=b.remote_db;return n.getUser(t).then(function(t){console.log(t),e.resolve(t)})["catch"](function(t){console.log(t),e.reject(t)}),e.promise()},k=function(t){var e=$.Deferred(),n=b.remote_db;return n.getUser(t.id).then(function(n){t.ans===n.ans?e.resolve(n):e.reject("wrong answer")})["catch"](function(t){e.reject(t)}),e.promise()},p=function(t){var e=$.Deferred(),n=b.remote_db;return n.login("pwchanger","pwchanger").then(function(){return n.changePassword(t.id,t.pw)}).then(function(){return n.logout()}).then(function(t){e.resolve(t),console.log(t)})["catch"](function(t){console.log(t),e.reject(t)}),e.promise()},f=function(t){var e=$.Deferred();return b.local_db.put(t).then(function(t){e.resolve(t)})["catch"](function(t){console.log(t),e.reject(t)}),e.promise()},m=function(t,e){var n,a,o=[],i=0,r=$.Deferred();return t||e||(t=0,e=1e18),b.local_db.query(function(n,a){"todo"===n.type&&n._id>t&&n._id<e&&a(n)}).then(function(t){for(n=t.rows,a=n.length,i;a>i;i++)o.push(n[i].key);r.resolve(o)})["catch"](function(t){r.reject(t)}),r.promise()},a=function(t,e){b.local_db.get(t).then(function(t){return t.done=e,b.local_db.put(t)}).then(function(t){console.log(t)})["catch"](function(t){console.log(t)})},h=function(t){var e=$.Deferred();return b.local_db.bulkDocs(t).then(function(t){e.resolve(t)})["catch"](function(t){console.log(t),e.reject(t),alert("error!")}),e.promise()},g=function(t,e){var n,a,o=[],i=0,r=$.Deferred();return t||e||(t=0,e=1e19),b.local_db.query(function(n,a){"plan"===n.type&&n._id>t&&n._id<e&&a(n)}).then(function(t){for(n=t.rows,a=n.length,i;a>i;i++)console.log(n[i]),o.push(n[i].key);r.resolve(o)})["catch"](function(t){console.log("plan",t),r.reject(t)}),r.promise()},o=function(t){var e=$.Deferred();return b.local_db.put(t).then(function(t){e.resolve(t)})["catch"](function(t){e.reject(t)}),e.promise()},i=function(t,e){var n,a,o=[],i=0,r=$.Deferred();return t||e||(t=0,e=1e19),b.local_db.query(function(n,a){"dday"===n.type&&n._id>t&&n._id<e&&a(n)}).then(function(t){for(n=t.rows,a=n.length,i;a>i;i++)console.log(n[i]),o.push(n[i].key);r.resolve(o)})["catch"](function(t){console.log("dday",t),r.reject(t)}),r.promise()},n=function(t){var e=$.Deferred();return b.local_db.get(t).then(function(t){return b.local_db.remove(t)}).then(function(t){e.resolve(t)})["catch"](function(t){e.reject(t)}),e.promise()},y=function(){return!0},r=function(t){var e=$.Deferred(),n=b.local_db,a={live:!0};return n.replicate.to(b.dbhost+t,a,function(t){console.log(t)}),n.replicate.from(b.dbhost+t,a,function(t){console.log(t)}),e.promise()},v=function(t){var e=$.Deferred(),n=b.local_db;return n.replicate.to(b.dbhost+t,function(t){t?(console.log(t),e.reject(t)):e.resolve()}),e.promise()},w=function(t){var e=$.Deferred(),n=b.local_db;return n.replicate.from(b.dbhost+t,function(t){t?(console.log(t),e.reject(t)):e.resolve()}),e.promise()},e=function(t,e){var n={auto_compaction:!0};(null===e||void 0===e)&&(e="http://zerohch0.iriscouch.com/"),b.remote_db=t?new PouchDB(e+t,n):new PouchDB(e+"/zerohch0",n),b.dbhost=e},t=function(){var t={auto_compaction:!0};return e(),b.local_db=new PouchDB("local",t),!0},{todoToggle:a,configModule:e,initModule:t,login:d,logout:s,setTodo:f,getTodo:m,setPlan:h,getPlan:g,getInfo:y,setDday:o,getDday:i,sync:r,join:l,checkId:c,upload:v,download:w,findId:u,changePw:p,checkAnswer:k,deleteItem:n}}(),zp.util=function(){var t,e;return t=function(t,e,n){var a=new Error;return a.name=t,a.message=e,n&&(a.data=n),a},e=function(e){var n,a,o=e.input_map,i=e.settable_map,r=e.config_map;for(n in o)if(o.hasOwnProperty(n)){if(!i.hasOwnProperty(n))throw a=t("Bad Input","Setting config key |"+n+"| is not supported");r[n]=o[n]}},{makeError:t,setConfigMap:e}}(),zp.util_b=function(){"use strict";var t,e,n,a={regex_encode_html:/[&"'><]/g,regex_encode_noamp:/["'><]/g,html_encode_map:{"&":"&#38;",'"':"&#34;","'":"&#39;",">":"&#62;","<":"&#60;"}};return a.encode_noamp_map=$.extend({},a.html_encode_map),delete a.encode_noamp_map["&"],t=function(t){return $("<div/>").html(t||"").text()},e=function(t,e){var n,o,i=String(t);return e?(o=a.encode_noamp_map,n=a.regex_encode_noamp):(o=a.html_encode_map,n=a.regex_encode_html),i.replace(n,function(t){return o[t]||""})},n=function(t){return Number(getComputedStyle(t,"").fontSize.match(/\d*\.?\d*/)[0])},{decodeHtml:t,encodeHtml:e,getEmSize:n}}(),zp.calendar=function(){"use strict";var t,e,n,a,o,i,r,d,l,c,s,u,p,f,h,m,g={main_html:String()+'<table class="calendar-table"><caption class="calendar-caption"></caption><thead><tr><th>주</th><th>일</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th><th>토</th></tr></thead><tbody><tr><th></th><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><th></th><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><th></th><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><th></th><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><th></th><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><th></th><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table>',day_list:["일","월","화","수","목","금","토"]},y={$container:null},v={};return e=function(t){var e=0;for(v={$container:t,$table:t.find("table"),$caption:t.find("caption")},e;6>=e;e++)v["$tr"+e]=t.find("tr:eq("+e+")")},t=function(t,n){var o=n.month,i=n.year;y.$container=t,t.html(g.main_html),e(t),a(o,i)},a=function(t,e){t=parseInt(t,10),e=parseInt(e,10);var a,i,r,d,l,c=new Date,s=1,u=2,p=new Date;for(c.setYear(e),c.setMonth(t-1),c.setDate(1),a=c.getDay(),c.setMonth(t),c.setDate(c.getDate()-1),i=c.getDate(),v.$caption.html(t+"월"),d=o(s,t,e),r=a;7>r;r++)v.$tr1.find("th").html(d+"주"),v.$tr1.find("td").eq(r).append("<div>"+s+"</div>"),s++;for(d++;i-7>=s;){for(r=0;7>r;r++)v["$tr"+String(u)].find("th").html(d+"주"),v["$tr"+String(u)].find("td").eq(r).append("<div>"+s+"</div>"),s++;u++,d++}for(r=0;i>=s;r++)v["$tr"+String(u)].find("th").html(d+"주"),v["$tr"+String(u)].find("td").eq(r).append("<div>"+s+"</div>"),s++;switch(u){case 4:v.$tr5.addClass("hidden"),v.$tr6.addClass("hidden");break;case 5:v.$tr6.addClass("hidden")}e===p.getFullYear()&&t===p.getMonth()+1&&(l=v.$table.find("td"),l.each(function(){parseInt($(this).find("div").eq(0).html(),10)===p.getDate()&&$(this).addClass("td-today")})),n(t,e)},n=function(t,e){var n,a=v.$table.find("td"),o=s(e+"0101","ltos"),i=s(e+"0408","ltos"),r=s(e+"0815","ltos");switch(t===o.month?a.each(function(){n=parseInt($(this).text(),10),(n===o.day||n===o.day-1||n===o.day+1)&&$(this).css("color","red")}):t===i.month?a.each(function(){n=parseInt($(this).text(),10),n===i.day&&$(this).css("color","red")}):t===r.month&&a.each(function(){n=parseInt($(this).text(),10),(n===r.day||n===r.day-1||n===r.day+1)&&$(this).css("color","red")}),t){case 1:a.each(function(){1===parseInt($(this).text(),10)&&$(this).css("color","red")});break;case 3:a.each(function(){1===parseInt($(this).text(),10)&&$(this).css("color","red")});break;case 5:a.each(function(){5===parseInt($(this).text(),10)&&$(this).css("color","red")});break;case 6:a.each(function(){6===parseInt($(this).text(),10)&&$(this).css("color","red")});break;case 8:a.each(function(){15===parseInt($(this).text(),10)&&$(this).css("color","red")});break;case 10:a.each(function(){(3===parseInt($(this).text(),10)||9===parseInt($(this).text(),10))&&$(this).css("color","red")});break;case 12:a.each(function(){25===parseInt($(this).text(),10)&&$(this).css("color","red")})}return!0},s=function(t,e){if("ltos"!==e&&"stol"!==e)return!1;var n,a,o,r,d,l,c,s,u,p,f,h,m,g,$,y,v,w,k,b,_,D,x,z,M=[[1,2,4,1,1,2,1,2,1,2,2,1],[2,2,1,2,1,1,2,1,2,1,2,1],[2,2,2,1,2,1,4,1,2,1,2,1],[2,2,1,2,1,2,1,2,1,2,1,2],[1,2,1,2,2,1,2,1,2,1,2,1],[2,1,2,1,5,2,1,2,2,1,2,1],[2,1,1,2,1,2,1,2,2,2,1,2],[1,2,1,1,2,1,2,1,2,2,2,1],[2,1,2,3,2,1,2,1,2,1,2,2],[2,1,2,1,1,2,1,1,2,2,1,2],[2,2,1,2,1,1,2,1,2,1,5,2],[2,1,2,2,1,1,2,1,2,1,1,2],[2,1,2,2,1,2,1,2,1,2,1,2],[1,2,1,2,1,2,5,2,1,2,1,2],[1,1,2,1,2,2,1,2,2,1,2,1],[2,1,1,2,1,2,1,2,2,2,1,2],[1,2,1,1,5,2,1,2,1,2,2,2],[1,2,1,1,2,1,1,2,2,1,2,2],[2,1,2,1,1,2,1,1,2,1,2,2],[2,1,6,1,1,2,1,1,2,1,2,2],[1,2,2,1,2,1,2,1,2,1,1,2],[2,1,2,1,2,2,1,2,2,3,1,2],[1,2,2,1,2,1,2,2,1,2,1,2],[1,1,2,1,2,1,2,2,1,2,2,1],[2,1,1,2,4,1,2,2,1,2,2,1],[2,1,1,2,1,1,2,2,1,2,2,2],[1,2,1,1,2,1,1,2,1,2,2,2],[1,2,2,3,2,1,1,2,1,2,2,1],[2,2,2,1,1,2,1,1,2,1,2,1],[2,2,2,1,2,1,2,1,1,5,2,1],[2,2,1,2,2,1,2,1,2,1,1,2],[1,2,1,2,2,1,2,1,2,2,1,2],[1,1,2,1,2,4,2,1,2,2,1,2],[1,1,2,1,2,1,2,1,2,2,2,1],[2,1,1,2,1,1,2,1,2,2,2,1],[2,2,1,1,5,1,2,1,2,2,1,2],[2,2,1,1,2,1,1,2,1,2,1,2],[2,2,1,2,1,2,1,1,2,1,2,1],[2,2,4,2,1,2,1,1,2,1,2,1],[2,1,2,2,1,2,2,1,2,1,1,2],[1,2,1,2,1,2,5,2,2,1,2,1],[1,2,1,2,1,2,1,2,2,1,2,2],[1,1,2,1,1,2,1,2,2,2,1,2],[2,1,1,2,3,2,1,2,2,1,2,2],[2,1,1,2,1,1,2,1,2,1,2,2],[2,1,2,1,2,1,1,2,1,2,1,2],[2,2,1,5,2,1,1,2,1,2,1,2],[2,1,2,2,1,2,1,1,2,1,2,1],[2,1,2,2,1,2,1,2,1,2,1,2],[1,5,2,1,2,2,1,2,1,2,1,2],[1,2,1,2,1,2,1,2,2,1,2,2],[1,1,2,1,1,5,2,2,1,2,2,2],[1,1,2,1,1,2,1,2,1,2,2,2],[1,2,1,2,1,1,2,1,2,1,2,2],[2,1,2,1,5,1,2,1,2,1,2,1],[2,2,2,1,2,1,1,2,1,2,1,2],[1,2,2,1,2,1,2,1,2,1,2,1],[2,1,5,2,2,1,2,1,2,1,2,1],[2,1,2,1,2,1,2,2,1,2,1,2],[1,2,1,1,2,1,2,5,2,2,1,2],[1,2,1,1,2,1,2,1,2,2,2,1],[2,1,2,1,1,2,1,2,1,2,2,2],[1,2,1,2,3,2,1,1,2,2,1,2],[2,2,1,2,1,1,2,1,1,2,2,1],[2,2,1,2,2,1,1,2,1,2,1,2],[1,2,2,4,1,2,1,2,1,2,1,2],[1,2,1,2,1,2,2,1,2,1,2,1],[2,1,1,2,2,1,2,1,2,2,1,2],[1,5,1,2,1,2,1,2,2,2,1,2],[1,2,1,1,2,1,2,1,2,2,2,1],[2,1,2,1,1,5,1,2,2,1,2,2],[2,1,2,1,1,2,1,1,2,2,1,2],[2,2,1,2,1,1,2,1,1,2,1,2],[2,2,1,2,5,1,2,1,2,1,1,2],[2,1,2,2,1,2,1,2,1,2,1,2],[1,2,1,2,1,2,2,1,2,1,2,1],[2,3,2,1,2,2,1,2,2,1,2,1],[2,1,1,2,1,2,1,2,2,2,1,2],[1,2,1,1,2,1,5,2,2,1,2,2],[1,2,1,1,2,1,1,2,2,1,2,2],[2,1,2,1,1,2,1,1,2,1,2,2],[2,1,2,2,3,2,1,1,2,1,2,2],[1,2,2,1,2,1,2,1,2,1,1,2],[2,1,2,1,2,2,1,2,1,2,1,1],[2,1,2,5,2,1,2,2,1,2,1,2],[1,1,2,1,2,1,2,2,1,2,2,1],[2,1,1,2,1,2,1,2,2,1,2,2],[1,5,1,2,1,1,2,2,1,2,2,2],[1,2,1,1,2,1,1,2,1,2,2,2],[1,2,2,1,1,5,1,2,1,2,2,1],[2,2,2,1,1,2,1,1,2,1,2,1],[2,2,2,1,2,1,2,1,1,2,1,2],[1,2,2,1,6,1,2,1,2,1,1,2],[1,2,1,2,2,1,2,2,1,2,1,2],[1,1,2,1,2,1,2,2,1,2,2,1],[2,1,4,1,2,1,2,1,2,2,2,1],[2,1,1,2,1,1,2,1,2,2,2,1],[2,2,1,1,2,1,4,1,2,2,1,2],[2,2,1,1,2,1,1,2,1,2,1,2],[2,2,1,2,1,2,1,1,2,1,2,1],[2,2,1,2,2,4,1,1,2,1,2,1],[2,1,2,2,1,2,2,1,2,1,1,2],[1,2,1,2,1,2,2,1,2,2,1,2],[1,1,2,4,1,2,1,2,2,1,2,2],[1,1,2,1,1,2,1,2,2,2,1,2],[2,1,1,2,1,1,2,1,2,2,1,2],[2,5,1,2,1,1,2,1,2,1,2,2],[2,1,2,1,2,1,1,2,1,2,1,2],[2,2,1,2,1,2,3,2,1,2,1,2],[2,1,2,2,1,2,1,1,2,1,2,1],[2,1,2,2,1,2,1,2,1,2,1,2],[1,2,1,2,4,2,1,2,1,2,1,2],[1,2,1,1,2,2,1,2,2,1,2,2],[1,1,2,1,1,2,1,2,2,1,2,2],[2,1,4,1,1,2,1,2,1,2,2,2],[1,2,1,2,1,1,2,1,2,1,2,2],[2,1,2,1,2,1,1,5,2,1,2,2],[1,2,2,1,2,1,1,2,1,2,1,2],[1,2,2,1,2,1,2,1,2,1,2,1],[2,1,2,1,2,5,2,1,2,1,2,1],[2,1,2,1,2,1,2,2,1,2,1,2],[1,2,1,1,2,1,2,2,1,2,2,1],[2,1,2,3,2,1,2,1,2,2,2,1],[2,1,2,1,1,2,1,2,1,2,2,2],[1,2,1,2,1,1,2,1,1,2,2,1],[2,2,5,2,1,1,2,1,1,2,2,1],[2,2,1,2,2,1,1,2,1,2,1,2],[1,2,2,1,2,1,5,2,1,2,1,2],[1,2,1,2,1,2,2,1,2,1,2,1],[2,1,1,2,2,1,2,1,2,2,1,2],[1,2,1,1,5,2,1,2,2,2,1,2],[1,2,1,1,2,1,2,1,2,2,2,1],[2,1,2,1,1,2,1,1,2,2,2,1],[2,2,1,5,1,2,1,1,2,2,1,2],[2,2,1,2,1,1,2,1,1,2,1,2],[2,2,1,2,1,2,1,5,2,1,1,2],[2,1,2,2,1,2,1,2,1,2,1,1],[2,2,1,2,1,2,2,1,2,1,2,1],[2,1,1,2,1,6,1,2,2,1,2,1],[2,1,1,2,1,2,1,2,2,1,2,2],[1,2,1,1,2,1,1,2,2,1,2,2],[2,1,2,3,2,1,1,2,2,1,2,2],[2,1,2,1,1,2,1,1,2,1,2,2],[2,1,2,2,1,1,2,1,1,5,2,2],[1,2,2,1,2,1,2,1,1,2,1,2],[1,2,2,1,2,2,1,2,1,2,1,1],[2,1,2,2,1,5,2,2,1,2,1,2],[1,1,2,1,2,1,2,2,1,2,2,1],[2,1,1,2,1,2,1,2,2,1,2,2],[1,2,1,1,5,1,2,1,2,2,2,2],[1,2,1,1,2,1,1,2,1,2,2,2],[1,2,2,1,1,2,1,1,2,1,2,2],[1,2,5,2,1,2,1,1,2,1,2,1],[2,2,2,1,2,1,2,1,1,2,1,2],[1,2,2,1,2,2,1,5,2,1,1,2],[1,2,1,2,2,1,2,1,2,2,1,2],[1,1,2,1,2,1,2,2,1,2,2,1],[2,1,1,2,3,2,2,1,2,2,2,1],[2,1,1,2,1,1,2,1,2,2,2,1],[2,2,1,1,2,1,1,2,1,2,2,1],[2,2,2,3,2,1,1,2,1,2,1,2],[2,2,1,2,1,2,1,1,2,1,2,1],[2,2,1,2,2,1,2,1,1,2,1,2],[1,5,2,2,1,2,1,2,2,1,1,2],[1,2,1,2,1,2,2,1,2,2,1,2],[1,1,2,1,2,1,5,2,2,1,2,2],[1,1,2,1,1,2,1,2,2,2,1,2],[2,1,1,2,1,1,2,1,2,2,1,2],[2,2,1,1,5,1,2,1,2,1,2,2],[2,1,2,1,2,1,1,2,1,2,1,2],[2,1,2,2,1,2,1,1,2,1,2,1],[2,1,6,2,1,2,1,1,2,1,2,1],[2,1,2,2,1,2,1,2,1,2,1,2],[1,2,1,2,1,2,1,2,5,2,1,2],[1,2,1,1,2,1,2,2,2,1,2,2],[1,1,2,1,1,2,1,2,2,1,2,2],[2,1,1,2,3,2,1,2,1,2,2,2],[1,2,1,2,1,1,2,1,2,1,2,2],[2,1,2,1,2,1,1,2,1,2,1,2],[2,1,2,5,2,1,1,2,1,2,1,2],[1,2,2,1,2,1,2,1,2,1,2,1],[2,1,2,1,2,2,1,2,1,2,1,2],[1,5,2,1,2,1,2,2,1,2,1,2],[1,2,1,1,2,1,2,2,1,2,2,1],[2,1,2,1,1,5,2,1,2,2,2,1],[2,1,2,1,1,2,1,2,1,2,2,2],[1,2,1,2,1,1,2,1,1,2,2,2],[1,2,2,1,5,1,2,1,1,2,2,1],[2,2,1,2,2,1,1,2,1,1,2,2],[1,2,1,2,2,1,2,1,2,1,2,1],[2,1,5,2,1,2,2,1,2,1,2,1],[2,1,1,2,1,2,2,1,2,2,1,2],[1,2,1,1,2,1,5,2,2,2,1,2],[1,2,1,1,2,1,2,1,2,2,2,1],[2,1,2,1,1,2,1,1,2,2,1,2],[2,2,1,2,1,4,1,1,2,1,2,2],[2,2,1,2,1,1,2,1,1,2,1,2],[2,2,1,2,1,2,1,2,1,1,2,1],[2,2,1,2,5,2,1,2,1,2,1,1],[2,1,2,2,1,2,2,1,2,1,2,1],[2,1,1,2,1,2,2,1,2,2,1,2],[1,5,1,2,1,2,1,2,2,2,1,2],[1,2,1,1,2,1,1,2,2,1,2,2]],S=[31,0,31,30,31,30,31,31,30,31,30,31],I=t.substring(0,4),T=t.substring(4,6),C=t.substring(6,8),q=[203];if("stol"===e){for(x=672069.2,k=I,_=T,S[1]=i(2,k),D=C||S[_-1],b=k-1,z=365*b+b/4-b/100+b/400+parseInt(D,10),m=0;_-1>m;m++)z+=S[m];for($=z-x+1,m=0;k-1841>=m;m++)for(q[m]=0,g=0;12>g;g++){switch(M[m][g]){case 1:s=29;break;case 2:s=30;break;case 3:s=58;break;case 4:s=59;break;case 5:s=59;break;case 6:s=60}q[m]=q[m]+s}for(y=0;;){if(!($>q[y]))break;$-=q[y],y+=1}for(v=0;;)if(M[y][v]<=2){if(s=M[y][v]+28,!($>s))break;$-=s,v+=1}else{switch(M[y][v]){case 3:f=29,h=29;break;case 4:f=29,h=30;break;case 5:f=30,h=29;break;case 6:f=30,h=30}if(!($>f))break;if($-=f,!($>h))break;$-=h,v+=1}return y+=1841,v+=1,w=$,{year:y,month:v,day:w}}if("ltos"===e){if(n=I,a=T,u=n-1841,f=a-1,r=0,M[u][f]>2)switch(M[u][f]){case 1:case 3:case 4:s=29;break;case 2:case 5:case 6:s=30}for(o=C,$=0,m=0;u>m;m++)for(g=0;12>g;g++)switch(M[m][g]){case 1:$+=29;break;case 2:$+=30;break;case 3:$+=58;break;case 4:$+=59;break;case 5:$+=59;break;case 6:$+=60}for(g=0;f>g;g++)switch(M[u][g]){case 1:$+=29;break;case 2:$+=30;break;case 3:$+=58;break;case 4:$+=59;break;case 5:$+=59;break;case 6:$+=60}if(1===r)switch(M[u][f]){case 3:case 4:$+=29;break;case 5:case 6:$+=30}for($=$+parseFloat(o)+22,u=1840;;){if(u+=1,p=u%400===0||u%100!==0&&u%4===0?366:365,p>=$)break;$-=p}for(d=u,S[1]=parseInt(p,10)-337,f=0;;){if(f+=1,$<=S[f-1])break;$-=S[f-1]}return l=parseInt(f,10),c=parseInt($,10),{year:d,month:l,day:c}}},p=function(t,e){var n,a;return e||(e=1),n=new Date(t.year,t.month-1,parseInt(t.date,10)+e),a={date:n.getDate(),month:n.getMonth()+1,year:n.getFullYear()},a.week=o(a.date,a.month,a.year),a.day=new Date(a.year,a.month-1,a.date).getDay(),a},u=function(t,e){var n,a;return e||(e=1),n=new Date(t.year,t.month-1,t.date-e),a={date:n.getDate(),month:n.getMonth()+1,year:n.getFullYear()},a.week=o(a.date,a.month,a.year),a.day=new Date(a.year,a.month-1,a.date).getDay(),a},h=function(t,e){e||(e=1);var n=u(t,e);return l(n)},f=function(t,e){e||(e=1);var n=p(t,e);return l(n)},l=function(t,e){var n,a="",o=t.date,i=t.month,r=t.year;return e||(e=""),a+=r,t.week?(n=t.week,a=a+e+n):i&&(10>i&&(a+=0),a=a+e+i),o&&(10>o&&(a+=0),a=a+e+o),a},d=function(t){if("string"!=typeof t)return console.warn("인자는 문자열이어야 합니다."),!1;var e,n,a,i;return 8===t.length?(n=t.substr(0,4),a=t.substr(4,2),i=t.substr(6,2)):10===t.length&&(n=t.substr(0,4),a=t.substr(5,2),i=t.substr(8,2)),e={year:parseInt(n,10),month:parseInt(a,10),date:parseInt(i,10),week:o(n,a,i)}},m=function(t,e,n){n||(n=(new Date).getFullYear());var a=new Date(n,e-1,t).getDay();return g.day_list[a]},r=function(t,e,n){var a=[31,28,31,30,31,30,31,31,30,31,30,31],o=0,r=0;if(n||(n=(new Date).getFullYear()),29===i(2,n)&&(a[1]=29),e){for(;e-1>o;)r+=a[o],o++;return r+=t}for(;t>0;)t-=a[o],o++;return e=o,t+=a[o-1],{month:e,date:t,year:n}},i=function(t,e){return e||(e=(new Date).getFullYear()),new Date(e,t,0).getDate()},c=function(t,e){var n,a,o=0,i=new Date(e,0,1).getDay(),d=[];for(e||(e=(new Date).getFullYear()),n=7*t-i-6,o;7>o;o++)a=r(n),d[o]={month:a.month,date:a.date},n++;return d},o=function(t,e,n){var a,o,i=new Date(n,0,1).getDay(),d=new Date(n,e-1,t).getDay(),l=6-d;return n||(n=(new Date).getFullYear()),o=r(t,e,n)+i+l,a=Math.floor(o/7),i>4&&(a-=1),a},{initModule:t,getWeekNum:o,dayOfYear:r,getWeekDay:c,daysInMonth:i,dayOfWeek:m,stringify:l,objectify:d,lunarSolar:s,getPrevDate:u,getNextDate:p,getPrevString:h,getNextString:f}}(),zp.shell=function(){"use strict";var t,e,n,a,o,i,r,d,l,c,s,u,p,f,h,m,g,y,v,w,k,b,_,D,x,z,M,S,I,T,C,q,O,P,N,F={anchor_schema_map:{current:{year:!0,month:!0,week:!0,day:!0,plan:!0,todo:!0,dday:!0},date:!0},today:{year:(new Date).getFullYear(),month:(new Date).getMonth()+1,date:(new Date).getDate(),week:zp.calendar.getWeekNum((new Date).getDate(),(new Date).getMonth()+1),day:(new Date).getDay()},day:["일","월","화","수","목","금","토"]},j={$container:null,anchor_map:{},current:"day",act:"reload",date_info:{year:F.today.year,month:F.today.month,date:F.today.date,week:F.today.week,day:F.today.day},state:"static",fidx:0},J={};return b=function(t){J={$container:t,$header:t.find("header"),$user:t.find(".user"),$avatar:t.find(".avatar"),$info:t.find(".info"),$name:t.find(".name"),$menu:t.find(".menu"),$logout:t.find("#menu-logout"),$profile:t.find("#menu-profile"),$upload:t.find("#menu-upload"),$download:t.find("#menu-download"),$option:t.find("#menu-option"),$report:t.find("#menu-report"),$main:t.find("main"),$flickView:t.find(".flick-view"),$flickCon:t.find(".flick-con"),$flick:t.find(".flick-panel"),$toggle:t.find(".tool-toggle"),$search:t.find(".tool-search"),$modal:t.find(".modal"),$intro:t.find(".intro")}},D=function(t,e){var n;t.preventDefault(),"static"===j.state?(n=String(e.year)+("0"+e.month).slice(-2)+("0"+e.date).slice(-2),v("day",n),T()):j.state="static"},x=function(t,e){var n;t.preventDefault(),"static"===j.state?(n=e.year+("0"+e.week).slice(-2),v("week",n),T()):j.state="static"},z=function(t,e){var n;t.preventDefault(),"static"===j.state?(n=e.year+("0"+e.month).slice(-2),v("month",n),T()):j.state="static"},M=function(t,e){var n;t.preventDefault(),"static"===j.state?(n=String(e.year),v("year",n),T()):j.state="static"},_=function(t,e){var n={};console.log("현재 mod: "+t),e.week=e.week||zp.calendar.getWeekNum(e.date,e.month,e.year),zp[t].initModule(J.$flick.eq(0),e),"day"===t?(n=zp.calendar.getNextDate(e),zp.day.initModule(J.$flick.eq(1),n),n=zp.calendar.getPrevDate(e),zp.day.initModule(J.$flick.eq(2),n)):"week"===t?(n.week=e.week+1,n.year=e.year,54===n.week&&(n.week=1,n.year+=1),zp.week.initModule(J.$flick.eq(1),n),n.week=e.week-1,0===n.week&&(n.week=53,n.year-=1),zp.week.initModule(J.$flick.eq(2),n)):"month"===t?(n={year:e.year,month:e.month+1},13===n.month&&(n.month=1,n.year+=1),zp.month.initModule(J.$flick.eq(1),n),n={year:e.year,month:e.month-1},0===n.month&&(n.month=12,n.year-=1),zp.month.initModule(J.$flick.eq(2),n)):"year"===t&&(n={year:e.year+1},zp.year.initModule(J.$flick.eq(1),n),n={year:e.year-1},zp.year.initModule(J.$flick.eq(2),n)),j.current=t,T(),p(e)},p=function(t){var e="",n="",a=j.current;switch(a){case"day":0===t.day?n='style="color:yellow;"':6===t.day&&(n='style="color:blue;"'),e='<span class="title-year">'+t.year+'</span>.<span class="title-month">'+t.month+'</span>.<span class="title-date">'+t.date+'</span> <span class="title-day" '+n+">"+F.day[t.day]+'</span> <span class="title-week">'+t.week+"주차</span>";break;case"week":t.week=t.week||zp.calendar.getWeekNum(t.date,t.month,t.year),e='<span class="title-year">'+t.year+'</span>년 <span class="title">'+t.week+"주차</span>";break;case"month":e='<span class="title-year">'+t.year+'년</span> <span class="title">'+t.month+"월</span>";break;case"year":e='<span class="title">'+t.year+"년</span>";break;case"todo":e='<span class="title">할일</span>';break;case"plan":e='<span class="title">일정</span>';break;case"dday":e='<span class="title">D-day / 기념일</span>'}return J.$info.html(e),t&&(t.hasOwnProperty("date")&&(j.date_info.date=t.date),t.hasOwnProperty("month")&&(j.date_info.month=t.month),t.hasOwnProperty("year")&&(j.date_info.year=t.year),t.hasOwnProperty("week")&&(j.date_info.week=t.week)),$.extend({},t)},u=function(){alert("처음이시군요!"),J.$intro.show(),confirm("다음 실행 때도 보시겠습니까?")||(localStorage.first="false")},a=function(t){return t.stopPropagation(),JSON.parse(localStorage.online)===!1?(zp.modal.initModule(J.$modal,"login").show(),!1):confirm("로그아웃하시겠습니까?")?(J.$name.html("로그인"),J.$avatar.html(""),localStorage.removeItem("user"),zp.model.logout(),localStorage.online=JSON.stringify(!1),alert("로그아웃되었습니다!"),J.$menu.hide(),zp.modal.initModule(J.$modal,"login").show(),void J.$modal.find("#login-id").focus()):!1},o=function(){var t;confirm("업로드하시겠습니까?")&&(t=zp.model.upload()),t.done(function(t){console.log(t)})},i=function(){var t;confirm("다운로드하시겠습니까?")&&(t=zp.model.download()),t.done(function(t){console.log(t)})},e=function(){zp.modal.initModule(J.$modal,"option").show()},n=function(){zp.modal.initModule(J.$modal,"profile").show()},t=function(){zp.modal.initModule(J.$modal,"report").show()},f=function(){T(),v("year",j.date_info.year),j.current="year",p(j.date_info)},h=function(){T(),v("month",j.date_info.year+("0"+j.date_info.month).slice(-2)),j.current="month",p(j.date_info)},m=function(){T(),v("week",j.date_info.year+("0"+j.date_info.week).slice(-2)),j.current="week",p(j.date_info)},I=function(t,e){var n,a,o=j.current;if(j.act="swipe",e.year=parseInt(e.year,10),e.month=parseInt(e.month,10),e.week=parseInt(e.week,10),"left"===t)switch(console.log("swiped to the left!"),a=(j.fidx+1)%3,o){case"day":e=p(zp.calendar.getNextDate(e)),n=zp.calendar.getNextDate(e),zp[o].initModule(J.$flick.eq(a),n),v(o,e.year+("0"+e.month).slice(-2)+("0"+e.date).slice(-2));break;case"week":e.week+=1,54===e.week&&(e.week=1,e.year+=1),n=p(e),n.week+=1,54===n.week&&(n.week=1,n.year+=1),zp.week.initModule(J.$flick.eq(a),n),v("week",e.year+("0"+e.week).slice(-2));break;case"month":e.month+=1,13===e.month&&(e.month=1,e.year+=1),n=p(e),n.month+=1,13===n.month&&(n.month=1,n.year+=1),zp.month.initModule(J.$flick.eq(a),n),v("month",e.year+("0"+e.month).slice(-2));break;case"year":e.year+=1,e=p(e),n=$.extend({},e),n.year+=1,zp.year.initModule(J.$flick.eq(a),n),v("year",e.year);break;case"todo":j.current="plan",p();break;case"plan":j.current="dday",p();break;case"dday":j.current="todo",p()}else switch(console.log("swiped to the right!"),a=(j.fidx-1)%3,o){case"day":e=p(zp.calendar.getPrevDate(e)),n=zp.calendar.getPrevDate(e),zp[o].initModule(J.$flick.eq(a),n),v(o,e.year+("0"+e.month).slice(-2)+("0"+e.date).slice(-2));break;case"week":e.week-=1,0===e.week&&(e.week=53,e.year-=1),n=p(e),n.week-=1,0===n.week&&(n.week=53,n.year-=1),zp.week.initModule(J.$flick.eq(a),n),v("week",e.year+("0"+e.week).slice(-2));break;case"month":e.month-=1,0===e.month&&(e.month=12,e.year-=1),n=p(e),n.month-=1,0===n.month&&(n.month=12,n.year-=1),zp[o].initModule(J.$flick.eq(a),n),v(o,e.year+("0"+e.month).slice(-2));break;case"year":e.year-=1,n=p(e),n.year-=1,zp[o].initModule(J.$flick.eq(a),n),v(o,e.year);break;case"todo":j.current="dday",p();break;case"plan":j.current="todo",p();break;case"dday":j.current="plan",p()}return J.$flick.eq(a).css("top",0),j.date_info=e,e},s=function(){return"true"!==localStorage.online?(zp.modal.initModule(J.$modal,"login").show(),!1):(J.$menu.toggle(),!1)},d=function(t,e){t&&t.preventDefault(),localStorage.online="true",J.$name.html(e.nick||e.name),J.$avatar.html(e.avatar||""),localStorage.user=JSON.stringify(e),zp.model.configModule(e.name),console.log("online mode"),!localStorage.first&&JSON.parse(localStorage.first)&&u()},r=function(){zp.modal.configModule({set_cur_anchor:v}),zp.modal.initModule(J.$modal,"search").show(),T()},c=function(t,e){t.preventDefault(),console.log("onSubmit",e),v(e)},l=function(t,e){t.preventDefault(),zp.modal.initModule(J.$modal,"type",e).show()},S=function(){var t=y().current;j.act="reload","todo"===t||"plan"===t||"dday"===t?(v("day"),J.$toggle.html('<i class="fa fa-list"></i>')):(v("todo"),J.$toggle.html('<i class="fa fa-calendar"></i>'))},y=function(){return $.extend(!0,{},j.anchor_map)},g=function(t){var e,n,a=y(),o=!0;for(e in t)if(t.hasOwnProperty(e)){if(0===e.indexOf("_"))continue;a[e]=t[e],void 0===t[e]&&(delete t[e],delete a[e]),n="_"+e,t[n]?a[n]=t[n]:(delete a[n],delete a["_s"+n])}try{$.uriAnchor.setAnchor(a)}catch(i){$.uriAnchor.setAnchor(j.anchor_map,null,!0),o=!1}return o},v=function(t,e){var n={current:t,date:e};return g(n)},w=function(){var t,e,n,a,o,i,r=y(),d={};console.log((new Date).getHours(),(new Date).getMinutes(),(new Date).getSeconds(),"해시가 변경이 시도되었습니다.");try{t=$.uriAnchor.makeAnchorMap()}catch(l){return console.warn("anchor_map_error",l),$.uriAnchor.setAnchor(r,null,!0),!1}if(void 0===t.current&&(t.current="day"),j.anchor_map=t,o=r._s_date,i=t._s_date,e=r._s_current,n=t._s_current,!Object.keys(r).length||e!==n||o!==i)switch(a=t.current){case"year":"reload"===j.act?(i&&(d.year=j.date_info.year=parseInt(i.substr(0,4),10)),_("year",d)):j.act="reload";break;case"month":"reload"===j.act?(i&&(d.year=j.date_info.year=parseInt(i.substr(0,4),10),d.month=j.date_info.month=parseInt(i.substr(4,2),10)),_("month",d)):j.act="reload";break;case"week":"reload"===j.act?(i&&(d.year=j.date_info.year=parseInt(i.substr(0,4),10),d.week=j.date_info.week=parseInt(i.substr(4,2),10)),_("week",d)):j.act="reload";break;case"day":"reload"===j.act?(i?(d.year=j.date_info.year=parseInt(i.substr(0,4),10),d.month=j.date_info.month=parseInt(i.substr(4,2),10),d.date=j.date_info.date=parseInt(i.substr(6,2),10)):(d.year=j.date_info.year,d.month=j.date_info.month,d.date=j.date_info.date),d.day=new Date(d.year,d.month-1,d.date).getDay(),d.week=zp.calendar.getWeekNum(d.date,d.month,d.year),_("day",d)):j.act="reload";break;case"plan":T(),zp.plan.initModule(J.$flick.eq(0)),zp.dday.initModule(J.$flick.eq(1)),zp.todo.initModule(J.$flick.eq(2)),j.current="plan",p();break;case"todo":T(),zp.todo.initModule(J.$flick.eq(0)),zp.plan.initModule(J.$flick.eq(1)),zp.dday.initModule(J.$flick.eq(2)),j.current="todo",p();break;case"dday":T(),zp.dday.initModule(J.$flick.eq(0)),zp.todo.initModule(J.$flick.eq(1)),zp.plan.initModule(J.$flick.eq(2)),j.current="dday",p();break;default:delete t.current,delete t.date,$.uriAnchor.setAnchor(t,null,!0)}},T=function(){J.$main.css("height",$(window).height()-J.$header.height()),J.$flick.css("min-height",$(window).height()-J.$header.height()),J.$flick.eq(0).css("left","0%"),J.$flick.eq(1).css("left","100%"),J.$flick.eq(2).css("left","-100%")},C=function(){var t,e,n;j.fidx%=3,t=j.fidx,e=t+1,n=t-1,0===t&&(n=2),2===t&&(e=0),console.log(n,t,e),J.$flick.eq(n).css({left:"-100%"}),J.$flick.eq(t).css({left:"0%"}),J.$flick.eq(e).css({left:"100%"})},q=function(t,e){var n,a=Math.abs(parseFloat((e/t).toFixed(2))),o=(window.innerHeight/2/window.innerWidth).toFixed(2),i=(window.innerHeight/(window.innerWidth/2)).toFixed(2);return n=a>=o?2:i>=a?0:1},N=function(t){return J.$flickCon.css({webkitTransition:"null"}),j.touch_start_x=j.touch_x=t.originalEvent.touches[0].clientX,j.touch_start_y=j.touch_y=t.originalEvent.touches[0].clientY,!0},P=function(t){j.touch_x=t.originalEvent.touches[0].clientX,j.touch_y=t.originalEvent.touches[0].clientY,j.gap_x=j.touch_x-j.touch_start_x,j.gap_y=j.touch_y-j.touch_start_y,j.direction=j.direction||q(j.gap_x,j.gap_y),0===j.direction&&(t.preventDefault(),J.$flickCon.css({transform:"translate3d("+j.gap_x+"px,0,0)"})),j.state="drag"},O=function(){return Math.abs(j.gap_x)>$(window).width()/2.5?(j.gap_x<0?(J.$flickCon.css({transform:"translate3d(-100%,0,0)",webkitTransition:"300ms"}),j.fidx++,I("left",j.date_info)):(J.$flickCon.css({transform:"translate3d(100%,0,0)",webkitTransition:"300ms"}),j.fidx--,I("right",j.date_info)),C(),J.$flickCon.delay(0).queue(function(t){$(this).css({transform:"translate3d(0,0,0)",webkitTransition:"null"}),t()})):J.$flickCon.css({transform:"translate3d(0,0,0)",webkitTransition:"200ms"}),j.direction=void 0,j.gap_x=0,!0},k=function(u){var p=localStorage.online?JSON.parse(localStorage.online):!1;$.uriAnchor.configModule({schema_map:F.anchor_schema_map}),localStorage.first=localStorage.first?JSON.parse(localStorage.first):JSON.stringify(!1),j.$container=u,b(u),p?d(window.event,JSON.parse(localStorage.user)):localStorage.user="anon",T(),$(window).on("error",function(t,e,n,a,o){t&&t.indexOf("Script error.")>-1||alert("Error: "+t+" Script: "+e+" Line: "+n+" Column: "+a+" StackTrace: "+o)}).on("hashchange",w).trigger("hashchange").on("orientationchange resize",function(){var t=$(window).height(),e=J.$header.height();J.$main.css("height",t-e),J.$flick.css("min-height",t-e)}),$.gevent.subscribe(J.$user,"login",d),$.gevent.subscribe(J.$container,"submit",c),$.gevent.subscribe(J.$main,"day",D),$.gevent.subscribe(J.$main,"week",x),$.gevent.subscribe(J.$main,"month",z),$.gevent.subscribe(J.$main,"year",M),$.gevent.subscribe(J.$modal,"cell",l),J.$user.on("click",s),J.$logout.on("click",a),J.$upload.on("click",o),J.$download.on("click",i),J.$option.on("click",e),J.$profile.on("click",n),J.$report.on("click",t),J.$toggle.on("click",S),J.$search.on("click",r),J.$info.on("click",".title-year",f),J.$info.on("click",".title-month",h),J.$info.on("click",".title-week",m),J.$flickView.on("touchstart",N).on("touchmove",P).on("touchend",O)},{initModule:k}}(),zp.day=function(){"use strict";var t,e,n,a,o,i,r,d,l={settable_map:{set_cur_anchor:!0},today:{year:(new Date).getFullYear(),month:(new Date).getMonth()+1,date:(new Date).getDate()},set_cur_anchor:null,tr_h:40},c={day_list:[],update:!1},s={};return t=function(t,e){s.$container=t,s[e]={$container:t,$ddayTable:t.find(".dday-table"),$planTable:t.find(".plan-table")}},i=function(e,n){var i,c={date:parseInt(n.date,10),month:parseInt(n.month,10),year:parseInt(n.year,10)},u=n.month,p=n.date,f=n.year;u=("0"+c.month).slice(-2),p=("0"+c.date).slice(-2),i=f+u+p,console.log(i,"모듈을 로딩합니다."),e.load("/html/zp.day.html",function(){t(e,i),a(n,i),c.date===l.today.date&&c.month===l.today.month&&c.year===l.today.year&&(r(i),setInterval(r(i),6e4)),s[i].$ddayTable.attr("data-date",i),s[i].$planTable.on("click",".todo, .plan, .dday",o),s[i].$planTable.on("click","td",n,d)})},d=function(t){var e=$(this).data("time"),n={year:t.data.year,month:t.data.month,date:t.data.date,time:e};$.gevent.publish("cell",[n])},o=function(){var t=$(this).attr("class");"whole"===t&&(t="plan"),$.gevent.publish("submit",[t])},r=function(t){var e,n,a,o=(new Date).getHours(),i=(new Date).getMinutes(),r=$(".time-indicator");a=s[t].$ddayTable.find("tr").length,n=o*l.tr_h+i*l.tr_h/60+40*a,r.length&&r.remove(),e=$("<div/>").addClass("time-indicator").css({top:n}),s[t].$container.prepend(e)},a=function(t,e){var n,a,o,i,r,d,c,u,p,f,h,m,g,y,v,w,k,b,_,D,x,z=$(document.createDocumentFragment());return a=("0"+t.month).slice(-2),n=("0"+t.date).slice(-2),w=t.year+"-"+a+"-"+n,u=new Date(w),d=u.getTime(),u.setDate(u.getDate()+1),c=u.getTime(),g=zp.model.getTodo(d+"00000",c+"00000"),y=zp.model.getPlan(d+"00000",c+"00000"),v=zp.model.getDday(d+"00000",c+"00000"),v.done(function(t){
for(m=0;m<t.length;m++)h=t[m],h&&h.target===w&&(b=$("<tr/>").attr("data-id",h._id).append("<td/>"),b.find("td").addClass("dday").text(h.text),b.prependTo(z));z.appendTo(s[e].$ddayTable)}),v.fail(function(t){console.log(t)}),g.done(function(t){for(m=0;m<t.length;m++)p=t[m],p&&p.date===w&&(D=p.time.substr(0,2),x=p.time.substr(3,2),_=D*l.tr_h+x*l.tr_h/60+1,k=$("<div/>").addClass("todo").attr("data-id",p._id),k.css({top:_}).append($("<div/>")).find("div").addClass("input").text(p.text),k.appendTo(z));z.appendTo(s[e].$planTable)}),g.fail(function(t){console.log(t)}),y.done(function(t){for(m=0;m<t.length;m++)f=t[m],f&&(o=new Date(f.startdate).getTime(),i=new Date(f.enddate).getTime(),r=new Date(w).getTime(),f.startdate===w?(D=f.starttime.substr(0,2),x=f.starttime.substr(3,2),_=D*l.tr_h+x*l.tr_h/60+1,k=$("<div/>").addClass("plan").attr("data-id",f._id),k.css({top:_}).append($("<div/>")).find("div").addClass("input").text(f.text+" 시작"),k.appendTo(s[e].$planTable)):r>o&&i>r?(b=$("<tr/>").attr("data-idx",m).append("<td/>"),b.find("td").addClass("whole").text(f.text),b.prependTo(s[e].$ddayTable)):f.enddate===w&&(D=f.endtime.substr(0,2),x=f.endtime.substr(3,2),_=D*l.tr_h+x*l.tr_h/60+1,k=$("<div/>").addClass("plan").attr("data-idx",m),k.css({top:_}).append($("<div/>")).find("div").addClass("input").text(f.text+"끝"),k.appendTo(z)));z.appendTo(s[e].$planTable)}),y.fail(function(t){console.log(t)}),!0},e=function(t){return zp.util.setConfigMap({input_map:t,settable_map:l.settable_map,config_map:l}),!0},n=function(t,e){var n=e.year+("0"+e.month).slice(-2)+("0"+e.date).slice(-2);return c.day_list[n]=new i(t,e),c.day_list},{configModule:e,initModule:n}}(),zp.dday=function(){"use strict";var t,e,n,a,o,i,r,d,l,c,s,u,p={settable_map:{set_cur_anchor:!0},set_cur_anchor:null},f={$container:null,taphold:null},h={};return t=function(t){h={$container:t,$main:t.find(".dday-main")}},i=function(t){var e,n=new Date,a=zp.calendar.objectify(String(t)),o=new Date(a.year,a.month-1,a.date),i=o.getTime()-n.getTime();return i=Math.ceil(i/1e3/60/60/24),e=i>0?"D-"+i:0===i?"D-day":"D+"+Math.abs(i)},e=function(){var t,e,n,a,o,r,d,l,c=$(document.createDocumentFragment()),s=zp.model.getDday();return s.done(function(s){if(s.length){for(h.$main.html(""),l=0;l<s.length;l++)a=s[l],a&&(d=a.target,e=$("<div/>").addClass("dday-item").attr("data-id",a._id),t=$("<div/>").addClass("dday-text").text(a.text),o=$("<div/>").addClass("dday-target").text(d),r=$("<div/>").addClass("dday-left").text(i(d)),n=$("<div/>").addClass("dday-del").html('<i class="fa fa-trash-o"></i>'),e.append(r).append(t).append(o).append(n),c.append(e));h.$main.append(c)}}),s.fail(function(t){alert(t)}),h.$main.html('<div class="no-content">기념일이나 D-day를 작성해주세요</div>'),!0},o=function(){var t,e=$(this).closest(".dday-item"),n=e.data("id");return confirm("삭제하시겠습니까?")?(t=zp.model.deleteItem(n),t.done(function(){e.remove()}),t.fail(function(){alert("오류 발생")}),!0):!1},l=function(t){return console.log("holdtap"),t.stopImmediatePropagation(),f.taphold=setTimeout(function(){"dday-text"===t.target.className?d(t.target):"dday-target"===t.target.className&&r(t.target)},1e3),!1},c=function(t){return console.log("holdstop"),t.stopPropagation(),clearTimeout(f.taphold),!1},r=function(t){var e=$(t).text();$(t).empty().append('<input type="text" value="'+e+'"/>'),$(t).find("input").focus().on("blur",{target:t,origin:e},s)},d=function(t){var e=$(t).text();$(t).empty().append('<input type="text" value="'+e+'"/>'),$(t).find("input").focus().on("blur",{target:t,origin:e},u)},s=function(t){var e,n,a=t.data,o=$(a.target),i=o.find("input").val();return a.origin===i?void o.empty().text(a.origin):(o.empty().text(i),e=o.parent(".dday-item").data("id"),void(n=i.substr(0,10)))},u=function(t){var e,n,a,o=t.data,i=$(o.target),r=i.find("input").val();return o.origin===r?void i.empty().text(o.origin):(i.empty().text(r),e=JSON.parse(localStorage.change),n=JSON.parse(localStorage.dday),a=i.parent(".dday-item").data("id"),alert(a),n[a].text=r,e.u.push({cidx:a,type:"dday"}),localStorage.dday=JSON.stringify(n),void(localStorage.change=JSON.stringify(e)))},n=function(t){zp.util.setConfigMap({input_map:t,settable_map:p.settable_map,config_map:p})},a=function(n){return n.load("/html/zp.dday.html",function(){f.$container=n,t(n),e(),h.$main.on("click",".dday-del",o),h.$main.on("touchstart",".dday-target, .dday-text",l),h.$main.on("touchend",".dday-target, .dday-text",c)}),n},{configModule:n,initModule:a,calculate:i}}(),zp.modal=function(){"use strict";var t,e,n,a,o,i,r,d,l,c,s,u,p,f,h,m,g,y,v,w,k,b,_,D,x,z,M,S={settable_map:{set_cur_anchor:!0},set_cur_anchor:null,today:{year:(new Date).getFullYear(),month:(new Date).getMonth()+1,date:(new Date).getDate()}},I={$container:null,year:(new Date).getFullYear(),month:(new Date).getMonth()+1,date:(new Date).getDate(),hour:(new Date).getHours(),minute:(new Date).getMinutes()},T={};return t=function(t){T={$container:t,$close:t.find(".modal-close"),$back:t.find(".modal-back"),$login:t.find("#login-sbmt"),$todo:t.find("#todo-sbmt"),$plan:t.find("#plan-sbmt"),$dday:t.find("#dday-sbmt"),$join:t.find("#join-btn"),$findpw:t.find("#findpw-btn"),$offline:t.find("#offline-btn"),$typeTodo:t.find("#type-todo"),$typePlan:t.find("#type-plan"),$typeDday:t.find("#type-dday"),$checkIdBtn:t.find("#check-id-btn"),$joinSbmt:t.find("#join-sbmt"),$findIdForm:t.find("#findpw-id-form"),$findIdBtn:t.find("#findpw-id-sbmt"),$findPwForm:t.find("#findpw-qst-form"),$findPwBtn:t.find("#findpw-ans-sbmt"),$newPwForm:t.find("#findpw-newpw-form"),$newPwBtn:t.find("#findpw-newpw-sbmt"),$repeat:t.find("#plan-input-repeat"),$repeatType:t.find('input[name="repeat-type"]'),$search:t.find("#search-btn"),$today:t.find("#search-today")}},m=function(t){var e,n,a=$(this).parent(),o=a.find("#login-id"),i=a.find("#login-pw"),r=o.val(),d=i.val();return t.preventDefault(),""===r.trim()?(alert("아이디를 입력해주십시오."),o.focus(),!1):""===d?(alert("비밀번호를 입력해주십시오."),i.focus(),!1):(e={id:r,pw:d},n=zp.model.login(e),n.done(function(t){alert("로그인 성공!"),T.$container.hide(),$.gevent.publish("login",[t]),confirm("서버의 데이터와 동기화하시겠습니까?")&&zp.model.sync(r)}),void n.fail(function(){return alert("아이디가 없거나 패스워드가 틀렸습니다."),o.val("").focus(),i.val(""),!1}))},i=function(t){zp.modal.initModule(T.$container,"todo",t.data)},r=function(t){zp.modal.initModule(T.$container,"plan",t.data)},d=function(t){zp.modal.initModule(T.$container,"dday",t.data)},y=function(){$.gevent.publish("zp-offline",[]),T.$container.hide()},a=function(){T.$container.empty().hide()},o=function(){zp.modal.initModule(T.$container,"login")},_=function(){zp.modal.initModule(T.$container,"findpw")},D=function(t){var e,n={id:T.$findIdForm.find("#findpw-id").val()};return t.preventDefault(),e=zp.model.findId(n.id),e.done(function(t){T.$findIdForm.find("#findpw-id").prop("readonly",!0),T.$findPwForm.show(),T.$findPwForm.find("#findpw-ans").focus(),T.$findPwForm.find("#findpw-qst").html(t.qst)}),e.fail(function(){alert("아이디가 없습니다.")}),!1},x=function(t){var e,n={id:T.$findIdForm.find("#findpw-id").val(),ans:T.$findPwForm.find("#findpw-ans").val()};t.preventDefault(),n.ans||(alert("답변을 입력해주세요"),T.$findPwForm.find("#findpw-ans").focus()),e=zp.model.checkAnswer(n),e.done(function(){T.$newPwForm.show(),T.$newPwForm.find("#findpw-newpw").focus()}),e.fail(function(t){"wrong answer"===t&&(alert("답변이 틀렸습니다."),T.$findPwForm.find("#findpw-ans").val("").focus())})},M=function(t){t.preventDefault();var e,n,a=T.$newPwForm.find("#findpw-newpw"),o=T.$newPwForm.find("#findpw-newpwchk");return e={id:T.$findIdForm.find("#findpw-id").val(),pw:a.val()},e.pw!==o.val()?(alert("비밀번호와 비밀번호 확인이 일치하지 않습니다"),void a.focus()):(n=zp.model.changePw(e),n.done(function(){alert("변경되었습니다!"),zp.modal.initModule(T.$container,"login")}),void n.fail(function(t){console.log(t),"not_found"===t.name&&alert("권한 오류!")}))},g=function(){zp.modal.initModule(T.$container,"join")},z=function(t){var e,n=$(t.target).prev().val();return""===n?(alert("아이디를 입력해주세요."),!1):(e=zp.model.checkId(n),e.fail(function(){return alert("이미 사용하고 있는 아이디입니다."),!1}),void e.done(function(t){console.log(t),"not_found"===t.name?(alert("사용하셔도 좋습니다!"),$("#join-agree").removeAttr("disabled")):alert("오류가 발생했습니다. 다시 시도해주세요.")}))},v=function(t){var e=/^[\-A-Za-z0-9_]+[\-A-Za-z0-9_.]*@[\-A-Za-z0-9_]+[\-A-Za-z0-9_.]*\.[A-Za-z]{2,5}$/,n=t.hasOwnProperty("data")?t.data.value:t;return t.hasOwnProperty("data")&&""===n?!1:"string"!=typeof n||""===n?(alert("이메일이 문자열이 아니거나 빈칸입니다."),!1):-1===n.search(e)?(alert("이메일 형식에 맞지 않습니다."),!1):!0},b=function(t){var e,n=$("#join-id"),a=$("#join-email"),o=$("#join-name"),i=$("#join-pw"),r=$("#join-pwc"),d=$("#join-qst"),l=$("#join-ans"),c=$("#join-agree"),s={id:n.val(),email:a.val(),pw:i.val(),nick:o.val(),qst:d.val(),ans:l.val(),avatar:"z"};return t.preventDefault(),s.id.trim()?s.email.trim()?s.nick.trim()?s.pw?s.qst.trim()?s.ans?s.pw!==r.val()?(alert("비밀번호 확인이 일치하지 않습니다."),i.focus(),!1):(c.prop("disabled")&&alert("중복확인을 해주세요."),c.is(":checked")?(e=zp.model.join(s),e.done(function(t){console.log(t),alert("회원이 되신 것을 축하드립니다!")}),void e.fail(function(t){console.log(t),alert("오류가 발생했습니다. 다시 시도해주세요.")})):(alert("약관에 동의하셔야 합니다."),c.focus(),!1)):(alert("답변을 입력해주세요."),l.focus(),!1):(alert("질문을 입력해주세요."),d.focus(),!1):(alert("비밀번호를 입력해주세요."),i.focus(),!1):(alert("닉네임을 입력해주세요."),o.focus(),!1):(alert("이메일을 입력해주세요."),a.focus(),!1):(alert("아이디를 입력해주세요."),n.focus(),!1)},u=function(){$(this).next().toggle()},h=function(){var t=$(".plan-repeat-everyweek"),e=t.find("input[name=repeat-day]");"everyday"===$(this).val()?(e.prop("checked",!0),t.hide()):"everyweek"===$(this).val()&&(e.prop("checked",!1),t.show())},p=function(){var t=$(this).parent().find("#plan-input-enddate");""===t.val()&&t.val($(this).val())},f=function(t){var e,n,a,o=$(this).prev("#search-date").val();return t.preventDefault(),o?(e=o.substr(0,4),n=o.substr(5,2),a=o.substr(8,2),""===a||"00"===a?""===n||"00"===n?S.set_cur_anchor("year",e):S.set_cur_anchor("month",e+n):S.set_cur_anchor("day",e+n+a),void T.$container.empty().hide()):(alert("날짜를 입력하세요"),!0)},w=function(t){var e,n,a;t.preventDefault(),n=S.today.month,a=S.today.date,10>n&&(n="0"+n),10>a&&(a="0"+a),e=String(S.today.year)+n+a,S.set_cur_anchor("day",e),T.$container.empty().hide()},k=function(){return("0000"+Math.floor(1e4*Math.random()+1)).slice(-5)},l=function(t){var e,n,a=$(this).parent(),o=a.find("#todo-input-date").val(),i=a.find("#todo-input-time").val(),r=a.find("#todo-input-text").val(),d=a.find("#todo-input-nodue").is(":checked");return t.preventDefault(),""===o||""===i||""===r?(alert("빈칸이 있습니다."),!1):(d===!0&&(o="nodue",i="nodue"),e={_id:new Date(o+" "+i).getTime()+k(),date:o,time:i,text:r,done:!1,type:"todo"},n=zp.model.setTodo(e),n.done(function(){T.$container.empty().hide(),console.log("successfully submit todo",n),$.gevent.publish("submit",["todo"])}),void n.fail(function(){alert("error!")}))},c=function(t){var e,n,a,o,i,r,d,l,c,s,u,p,f,h,m,g,y,v,w,b,_,D,x,z,M,S,I=$(this).parent(),C=I.find("#plan-input-startdate").val(),q=I.find("#plan-input-starttime").val(),O=I.find("#plan-input-enddate").val(),P=I.find("#plan-input-endtime").val(),N=I.find("#plan-input-text").val(),F=[];if(t.preventDefault(),""===C||""===N)return alert("빈칸이 있습니다"),!1;if(P||(n=new Date(C+" "+q),n.setHours(n.getHours()+1),a=("0"+(n.getMonth()+1)).slice(-2),o=("0"+n.getDate()).slice(-2),i=("0"+n.getHours()).slice(-2),r=("0"+n.getMinutes()).slice(-2),O=n.getFullYear()+"-"+a+"-"+o,P=i+":"+r),e={_id:new Date(C+" "+q).getTime()+k(),startdate:C,starttime:q,enddate:O,endtime:P,text:N,plan_idx:k(),type:"plan"},p=$.extend({},e),F.push(p),I.find("#plan-input-repeat").is(":checked")){for(e.num=I.find("#plan-input-number").val(),e.lastdate=I.find("#plan-input-lastdate").val(),e.day=I.find('input[name="repeat-day"]:checked').map(function(){return parseInt($(this).val(),10)}).get(),d=zp.calendar.objectify(e.startdate),f=new Date(d.year,d.month-1,d.date).getDay(),h=e.day.length,c=0;h>c;c++)if(f===e.day[c]){u=c;break}if(m=e.day.slice(0,u),e.day=e.day.slice(u,h).concat(m),e.day=e.day.map(function(t,n){var a,o=e.day[n+1]||e.day[0];return a=o-t,0>a&&(a+=7),a}),e.lastdate)for(g=new Date(e.startdate+" "+e.starttime),S=new Date(e.lastdate+" 00:00:00");g.getTime()<S.getTime();)console.log(g.toISOString(),S.toISOString()),g=new Date(e.startdate+" "+e.starttime),g.setDate(g.getDate()+e.day[c%h]),w=("0"+(g.getMonth()+1)).slice(-2),b=("0"+g.getDate()).slice(-2),v=("0"+g.getHours()).slice(-2),_=("0"+g.getMinutes()).slice(-2),y=new Date(e.enddate+" "+e.endtime),y.setDate(y.getDate()+e.day[c%h]),x=("0"+(y.getMonth()+1)).slice(-2),z=("0"+y.getDate()).slice(-2),D=("0"+y.getHours()).slice(-2),M=("0"+y.getMinutes()).slice(-2),s=Object.create(e),s.text=e.text,s.type="plan",s.plan_idx=e.plan_idx,s._id=g.getTime()+k(),e.startdate=s.startdate=g.getFullYear()+"-"+w+"-"+b,e.starttime=s.starttime=v+":"+_,e.enddate=s.enddate=y.getFullYear()+"-"+x+"-"+z,e.endtime=s.endtime=D+":"+M,F.push(s);if(e.num)for(c=0;c<e.num;c++)g=new Date(e.startdate+" "+e.starttime),g.setDate(g.getDate()+e.day[c%h]),w=("0"+(g.getMonth()+1)).slice(-2),b=("0"+g.getDate()).slice(-2),v=("0"+g.getHours()).slice(-2),_=("0"+g.getMinutes()).slice(-2),y=new Date(e.enddate+" "+e.endtime),y.setDate(y.getDate()+e.day[c%h]),x=("0"+(y.getMonth()+1)).slice(-2),z=("0"+y.getDate()).slice(-2),D=("0"+y.getHours()).slice(-2),M=("0"+y.getMinutes()).slice(-2),s=Object.create(e),s.text=e.text,s.type="plan",s.plan_idx=e.plan_idx,s._id=g.getTime()+k(),e.startdate=s.startdate=g.getFullYear()+"-"+w+"-"+b,e.starttime=s.starttime=v+":"+_,e.enddate=s.enddate=y.getFullYear()+"-"+x+"-"+z,e.endtime=s.endtime=D+":"+M,console.log(s.text,s.plan,s),F.push(s)}return console.log(F),l=zp.model.setPlan(F),l.done(function(t){console.log(t),T.$container.empty().hide(),$.gevent.publish("submit",["plan"]),console.log("plan registered",t)}),!1},s=function(t){var e,n,a=$(this).parent(),o=a.find("#dday-input-target").val(),i=a.find("#dday-input-text").val(),r=a.find("#dday-input-repeat").is(":checked");return t.preventDefault(),""===o||""===i?(alert("빈칸이 있습니다"),!1):(e={_id:new Date(o).getTime()+k(),target:o,text:i,repeat:r,type:"dday"},n=zp.model.setDday(e),n.done(function(t){console.log(t),T.$container.empty().hide(),$.gevent.publish("submit",["dday"]),console.log("dday registered",n)}),n.fail(function(t){console.log(t),alert("오류 발생")}),!1)},e=function(t){zp.util.setConfigMap({input_map:t,settable_map:S.settable_map,config_map:S})},n=function(e,n,k){if("string"!=typeof n)throw"initModule argument type error";return""===n&&(n="login"),e.load("/html/zp.modal.html #modal-"+n,function(){if(I.$container=e,t(e),k&&("todo"===n||"plan"===n||"dday"===n)){var S;k.month=k.month<10?"0"+k.month:k.month,k.date=k.date<10?"0"+k.date:k.date,S=k.year+"-"+k.month+"-"+k.date,k.time=4===k.time.length?"0"+k.time:k.time,"todo"===n?(e.find("#todo-input-date").val(S),e.find("#todo-input-time").val(k.time)):"plan"===n?(e.find("#plan-input-startdate").val(S),e.find("#plan-input-starttime").val(k.time)):"dday"===n&&e.find(".dday-input-target").val(S)}return $(document).on("blur","#join-email",{value:$(this).val()},v),T.$close.on("click",a),T.$login.on("click",m),T.$repeat.on("click",u),T.$todo.on("click",k,l),T.$plan.on("click",k,c),T.$dday.on("click",k,s),T.$plan.parent().find("#plan-input-startdate").on("blur",p),T.$typeTodo.on("click",k,i),T.$typePlan.on("click",k,r),T.$typeDday.on("click",k,d),T.$join.on("click",g),T.$back.on("click",o),T.$joinSbmt.on("click",b),T.$checkIdBtn.on("click",z),T.$findpw.on("click",_),T.$findIdBtn.on("click",D),T.$findPwBtn.on("click",x),T.$newPwBtn.on("click",M),T.$offline.on("click",y),T.$search.on("click",f),T.$today.on("click",w),T.$repeatType.on("change",h),e}),e},{configModule:e,initModule:n}}(),zp.month=function(){var t,e,n,a,o,i,r,d,l={settable_map:{set_cur_anchor:!0},set_cur_anchor:null},c={month_list:[]},s={};return d=function(t,e){var o,d=e.month,l=e.year;t.load("/html/zp.month.html",function(){10>d&&(d="0"+d),o=String(l)+d,console.log("month",o),n(t,o),a(e.month,e.year),s[o].$month.attr("data-date",o),s[o].$month.find("td").on("click",e,i),s[o].$month.find("tbody th").on("click",e,r)})},n=function(t,e){s.$container=t,s[e]={$month:t.find(".month-calendar")}},a=function(t,e){var n,a={month:t,year:e};return t=10>t?"0"+t:t,n=String(e)+t,zp.calendar.initModule(s[n].$month,a),o(n),!0},o=function(t){var e,n,a,o,i,r,d,l,c,u,p,f,h,m,g,y,v,w,k,b,_,D,x,z,M,S,I,T,C=parseInt(t.substr(0,4),10),q=parseInt(t.substr(4,2),10);return d=t.substr(0,4)+"-"+t.substr(4,2),r=new Date(d),o=r.getTime(),r.setMonth(r.getMonth()+1),i=r.getTime(),w=zp.model.getPlan(o+"00000",i+"00000"),k=zp.model.getDday(o+"00000",i+"00000"),v=zp.model.getTodo(o+"00000",i+"00000"),w.done(function(e){for(l=0;l<e.length;l++)a=e[l],console.log(a),a&&(b=a.startdate,M=new Date(b).getTime(),_=parseInt(b.substr(5,2),10),D=b.substr(8,2),x=a.enddate,S=new Date(x).getTime(),z=parseInt(x.substr(5,2),10),I=(S-M)/1e3/60/60/24,q>=_&&z>=q&&(h=s[t].$month.find("td"),h.each(function(){if($(this).find("div").eq(0).text()===D)for(m=$(this).index(),y=$("<div/>").addClass("month-plan").text(a.text),T=$(this).parent().children(),T.eq(m).append(y.clone()),console.log(m,I,T);I>0;)m++,console.log(T.eq(m)),T.eq(m).length?T.eq(m).append(y.clone()):(m=1,T=T.parent().next().children(),T.eq(m).append(y.clone())),console.log(m,I,T),I--})))}),w.fail(function(t){console.log(t)}),k.done(function(e){for(l=0;l<e.length;l++)n=e[l],n&&(c=n.target,u=parseInt(c.substr(0,4),10),p=parseInt(c.substr(5,2),10),f=c.substr(8,2),h=s[t].$month.find("td"),console.log(n),h.each(function(){$(this).find("div").eq(0).text()===f&&(console.log(f,$(this).find("div").eq(0).text()),y=$("<div/>").addClass("month-dday").text(n.text),$(this).append(y))}))}),k.fail(function(t){console.log(t)}),v.done(function(n){for(l=0;l<n.length;l++)e=n[l],e&&(g=e.date,u=parseInt(g.substr(0,4),10),p=parseInt(g.substr(5,2),10),f=g.substr(8,2),u===C&&p===q&&(h=s[t].$month.find("td"),h.each(function(){$(this).find("div").eq(0).text()===f&&(y=$("<div/>").addClass("month-todo").text(e.text),e.done?y.addClass("month-done"):new Date(g).getTime()<(new Date).getTime()&&y.addClass("month-due"),$(this).append(y))})))}),v.fail(function(t){console.log(t)}),!0},r=function(t){var e,n=parseInt(("0"+parseInt($(this).html(),10)).slice(-2),10),a=t.data.year;return"&nbsp;"===n?!1:("0"===n&&(a=--a,n=zp.calendar.getWeekNum(31,12,a)),e={week:n,year:a},void $.gevent.publish("week",[e]))},i=function(t){var e,n=parseInt($(this).find("div").eq(0).text(),10),a=t.data.month,o=t.data.year;""!=n&&(e={date:n,month:a,year:o},$.gevent.publish("day",[e]))},t=function(t){zp.util.setConfigMap({input_map:t,settable_map:l.settable_map,config_map:l})},e=function(t,e){var n=e.year+("0"+e.month).slice(-2);return c.month_list[n]=new d(t,e),t},{configModule:t,initModule:e}}(),zp.plan=function(){var t,e,n,a,o,i,r,d,l,c,s,u,p,f={settable_map:{set_cur_anchor:!0},set_cur_anchor:null},h={$container:null,taphold:null},m={};return t=function(t){m={$container:t,$main:t.find(".plan-main")}},a=function(){var t,e,n,a,o,i,r,d,l,c,s,u,p,f,h,g,y=$(document.createDocumentFragment());r=zp.model.getPlan(),r.done(function(r){if(r.length){for(m.$main.html(""),i=0;i<r.length;i++)t=r[i],t&&(e=t.startdate,n=t.starttime,a=t.enddate,o=t.endtime,d=e+" "+n,l=a+" "+o,c=$("<div/>").addClass("plan-item").attr("data-id",t._id),s=$("<div/>").addClass("plan-option"),u=$("<div/>").addClass("plan-del").html('<i class="fa fa-trash-o"></i>'),p=$('<div/>"').addClass("plan-alarm").html('<i class="fa fa-alarm"></i>'),f=$("<div/>").addClass("plan-text").text(t.text),h=$("<div/>").addClass("plan-start").text(d),g=$("<div/>").addClass("plan-end").text(l),s.append(u).append(p),c.append(h).append(g).append(f).append(s),y.append(c));m.$main.append(y)}}),m.$main.html('<div class="no-content">일정을 작성해주세요</div>')},o=function(){var t,e=$(this).closest(".plan-item"),n=e.data("id");return confirm("삭제하시겠습니까?")?(t=zp.model.deleteItem(n),t.done(function(){e.remove()}),t.fail(function(){alert("오류 발생")}),!0):!1},l=function(t){return console.log("holdtap"),t.stopImmediatePropagation(),h.taphold=setTimeout(function(){"plan-text"===t.target.className?d(t.target):"plan-start"===t.target.className?i(t.target):"plan-end"===t.target.className&&r(t.target)},1e3),!1},c=function(t){return console.log("holdstop"),t.stopPropagation(),clearTimeout(h.taphold),!1},i=function(t){var e=$(t).text();$(t).empty().append('<input type="text" value="'+e+'"/>'),$(t).find("input").focus().on("blur",{target:t,origin:e},s)},r=function(t){var e=$(t).text();$(t).empty().append('<input type="text" value="'+e+'"/>'),$(t).find("input").focus().on("blur",{target:t,origin:e},u)},d=function(t){var e=$(t).text();$(t).empty().append('<input type="text" value="'+e+'"/>'),$(t).find("input").focus().on("blur",{target:t,origin:e},p)},s=function(t){var e,n,a,o,i,r=t.data,d=$(r.target),l=d.find("input").val();return r.origin===l?void d.empty().text(r.origin):(d.empty().text(l),e=JSON.parse(localStorage.change),n=JSON.parse(localStorage.plan),a=d.parent(".plan-item").data("id"),o=l.substr(0,10),i=l.substr(11,8),alert(a),n[a].startdate=o,n[a].starttime=i,e.u.push({cidx:a,type:"plan"}),localStorage.plan=JSON.stringify(n),void(localStorage.change=JSON.stringify(e)))},u=function(t){var e,n,a,o,i,r=t.data,d=$(r.target),l=d.find("input").val();return r.origin===l?void d.empty().text(r.origin):(d.empty().text(l),e=JSON.parse(localStorage.change),n=JSON.parse(localStorage.plan),a=d.parent(".plan-item").data("id"),o=l.substr(0,10),i=l.substr(11,8),alert(a),n[a].enddate=o,n[a].endtime=i,e.u.push({cidx:a,type:"plan"}),localStorage.plan=JSON.stringify(n),void(localStorage.change=JSON.stringify(e)))},p=function(t){var e,n,a,o=t.data,i=$(o.target),r=i.find("input").val();return o.origin===r?void i.empty().text(o.origin):(i.empty().text(r),e=JSON.parse(localStorage.change),n=JSON.parse(localStorage.plan),a=i.parent(".plan-item").data("id"),alert(a),n[a].text=r,e.u.push({cidx:a,type:"plan"}),localStorage.plan=JSON.stringify(n),void(localStorage.change=JSON.stringify(e)))},e=function(t){zp.util.setConfigMap({input_map:t,settable_map:f.settable_map,config_map:f})},n=function(e){e.load("/html/zp.plan.html",function(){h.$container=e,t(e),a(),m.$main.on("click",".plan-del",o),m.$main.on("touchstart",".plan-text, .plan-start, .plan-end",l),m.$main.on("touchend",".plan-text, .plan-start, .plan-end",c)})},{configModule:e,initModule:n}}(),zp.todo=function(){"use strict";var t,e,n,a,o,i,r,d,l,c,s,u,p,f,h={settable_map:{set_cur_anchor:!0},set_cur_anchor:null},m={$container:null},g={};return t=function(t){g={$container:t,$main:t.find(".todo-main")}},e=function(){var t,e,n,a,o,i,r,d,l,c,s,u,p,f,h=$(document.createDocumentFragment());return f=zp.model.getTodo(),f.done(function(f){if(console.log(f),f.length){for(g.$main.html(""),p=0;p<f.length;p++)l=f[p],console.log(l),l&&(s=l.date,u=l.time,d=l.done,c=s+" "+u,a=$("<div/>").addClass("todo-item").attr("data-id",l._id),n=$("<div/>").addClass("todo-done").append('<input type="checkbox" size="3">'),r=$("<div/>").addClass("todo-option"),o=$("<div/>").addClass("todo-del").html('<i class="fa fa-trash-o"></i>'),i=$("<div/>").addClass("todo-alarm").html('<i class="fa fa-bell-o"></i>'),e=$("<div/>").addClass("todo-text").text(l.text),t=$("<div/>").addClass("todo-due").text(c),new Date(c).getTime()<(new Date).getTime()&&e.addClass("item-due"),d&&(n.find("input").prop("checked",!0),e.addClass("item-done")),r.append(o).append(i),a.append(n).append(e).append(r).append(t),h.append(a));g.$main.append(h)}}),f.fail(function(t){alert(t)}),g.$main.html('<div class="no-content">할일을 작성해주세요</div>'),!0},o=function(){var t=$(this).parent().next(),e=$(this).closest(".todo-item").data("id");return $(this).is(":checked")?($(this).prop("checked",!0),t.addClass("item-done"),zp.model.todoToggle(e,!0)):($(this).prop("checked",!1),t.removeClass("item-done"),zp.model.todoToggle(e,!1)),!0},i=function(){var t,e=$(this).closest(".todo-item"),n=e.data("id");return confirm("삭제하시겠습니까?")?(t=zp.model.deleteItem(n),t.done(function(){e.remove()}),t.fail(function(){alert("오류 발생")}),!0):!1},f=function(){var t,e,n={Android:/Android/,iOS:/like Mac OS X/};for(e in n)n.hasOwnProperty(e)&&n[e].test(navigator.userAgent)&&(t=e);return"Android"===t||"iOS"===t},r=function(){return f()?(alert("준비중입니다"),!1):(alert("모바일에서만 가능한 기능입니다"),!1)},c=function(t){return console.log("holdtap"),t.stopImmediatePropagation(),m.taphold=setTimeout(function(){"todo-text"===t.target.className?l(t.target):"todo-due"===t.target.className&&d(t.target)},1e3),!1},s=function(t){return console.log("holdstop"),t.stopPropagation(),clearTimeout(m.taphold),!1},d=function(t){var e=$(t).text();$(t).empty().append('<input type="text" value="'+e+'"/>'),$(t).find("input").focus().on("blur",{target:t,origin:e},u)},l=function(t){var e=$(t).text();$(t).empty().append('<input type="text" value="'+e+'"/>'),$(t).find("input").focus().on("blur",{target:t,origin:e},p)},u=function(t){var e,n,a,o,i,r=t.data,d=$(r.target),l=d.find("input").val();return r.origin===l?void d.empty().text(r.origin):(d.empty().text(l),e=JSON.parse(localStorage.change),n=JSON.parse(localStorage.todo),a=d.parent(".todo-item").data("idx"),o=l.substr(0,10),i=l.substr(11,8),alert(a),n[a].date=o,n[a].time=i,e.u.push({cidx:a,type:"todo"}),localStorage.todo=JSON.stringify(n),void(localStorage.change=JSON.stringify(e)))},p=function(t){var e,n,a,o=t.data,i=$(o.target),r=i.find("input").val();return o.origin===r?void i.empty().text(o.origin):(i.empty().text(r),e=JSON.parse(localStorage.change),n=JSON.parse(localStorage.todo),a=i.parent(".todo-item").data("idx"),alert(a),n[a].text=r,e.u.push({cidx:a,type:"todo"}),localStorage.todo=JSON.stringify(n),void(localStorage.change=JSON.stringify(e)))},n=function(t){zp.util.setConfigMap({input_map:t,settable_map:h.settable_map,config_map:h})},a=function(n){return n.load("/html/zp.todo.html",function(){m.$container=n,t(n),e(),g.$main.on("click","input[type=checkbox]",o),g.$main.on("click",".todo-del",i),g.$main.on("click",".todo-alarm",r),g.$main.on("touchstart",".todo-text, .todo-due",c),g.$main.on("touchend",".todo-text, .todo-due",s)}),n},{configModule:n,initModule:a}}(),zp.week=function(){var t,e,n,a,o,i,r,d={settable_map:{set_cur_anchor:!0},set_cur_anchor:null,tr_h:30},l={week_list:[]},c={};return r=function(t,e){var o,r=e.week,d=e.year;t.load("/html/zp.week.html",function(){o=d+("0"+r).slice(-2),n(t,o),a(r,d),c[o].$week.attr("data-week",o),c[o].$thead.on("click",e,i)})},n=function(t,e){c.$container=t,c[e]={$week:t.find(".week-table"),$thead:t.find("thead th"),$info:t.find(".week-info")}},a=function(t,e){var n,a=e+("0"+t).slice(-2),i=zp.calendar.getWeekDay(t,e),r=0;for(r;7>r;r++)n=i[r].month+"."+i[r].date,c[a].$thead.eq(r).text(n);return o(a),!0},o=function(t){var e,n,a,o,i,r,l,s,u,p,f,h,m,g,y,v,w,k,b,_,D,x=parseInt(t.substr(0,4),10),z=parseInt(t.substr(4,2),10),M=zp.calendar.getWeekDay(z,x);return D=t.substr(0,4)+"-"+("0"+M[0].month).slice(-2)+"-"+("0"+M[0].date).slice(-2),_=new Date(D),k=_.getTime(),_.setDate(_.getDate()+7),b=_.getTime(),i=zp.model.getTodo(k+"00000",b+"00000"),r=zp.model.getPlan(k+"00000",b+"00000"),l=zp.model.getDday(k+"00000",b+"00000"),console.log(t,"일정을 삽입합니다."),l.done(function(e){for(u=0;u<e.length;u++)if(n=e[u])for(console.log(n),p=0;7>p;p++)f=("0"+M[p].month).slice(-2),h=("0"+M[p].date).slice(-2),s=x+"-"+f+"-"+h,n.target===s&&(console.log(n.target,s),w=c[t].$info.children().eq(p),v=$("<div/>").addClass("week-dday").text(n.text).appendTo(w))}),l.fail(function(t){console.log(t)}),i.done(function(n){for(u=0;u<n.length;u++)if(e=n[u])for(p=0;7>p;p++)f=("0"+M[p].month).slice(-2),h=("0"+M[p].date).slice(-2),s=x+"-"+f+"-"+h,e.date===s&&(g=e.time.substr(0,2),y=e.time.substr(3,2),o=g*d.tr_h+y*d.tr_h/60+61,console.log("top",o),v=$("<div/>").addClass("week-todo").attr("data-id",e._id),e.done?v.addClass("week-done"):new Date(e.date).getTime()<(new Date).getTime()&&v.addClass("week-due"),m=14.285714*p+"%",v.css({top:o,left:m}).append($("<div/>")).find("div").addClass("input").text(e.text),v.appendTo(c[t].$week))}),i.fail(function(t){console.log(t)}),r.done(function(e){var n,i,r,l,k,b,_;for(u=0;u<e.length;u++)if(a=e[u])for(p=0;7>p;p++)f=("0"+M[p].month).slice(-2),h=("0"+M[p].date).slice(-2),s=x+"-"+f+"-"+h,n=new Date(a.startdate).getTime(),i=new Date(a.enddate).getTime(),r=new Date(s),r>=n&&i>=r&&(n===r?(g=a.starttime.substr(0,2),y=a.starttime.substr(3,2),o=g*d.tr_h+y*d.tr_h/60+61,r===i?(k=a.endtime.substr(0,2),b=a.endtime.substr(3,2),_=k*d.tr_h+b*d.tr_h/60+61,l=_-o):l=24*d.tr_h-o,v=$("<div/>").addClass("week-plan").attr("data-idx",u),m=14.285714*p+"%",v.css({top:o,left:m,height:l}).append($("<div/>")).find("div").addClass("input").text(a.text),v.appendTo(c[t].$week)):r>n&&i>r?(w=c[t].$info.children().eq(p),v=$("<div/>").addClass("week-whole").text(a.text).appendTo(w)):r===i&&(g=a.endtime.substr(0,2),y=a.endtime.substr(3,2),o=0,m=14.285714*p+"%",l=g*d.tr_h+y*d.tr_h/60+61,v=$("<div/>").addClass("week-plan").attr("data-idx",u),v.css({top:o,left:m,height:l}).append($("<div/>")).find("div").addClass("input").text(a.text),v.appendTo(c[t].$week)))}),r.fail(function(t){console.log(t)}),!0},i=function(t){var e,n=$(this).text(),a=parseInt(n.split(".")[1],10),o=parseInt(n.split(".")[0],10),i=t.data.year;""!==a&&(e={date:a,month:o,year:i},$.gevent.publish("day",[e]))},t=function(t){zp.util.setConfigMap({input_map:t,settable_map:d.settable_map,config_map:d})},e=function(t,e){var n=e.year+("0"+e.week).slice(-2);return l.week_list[n]=new r(t,e),l.week_list},{configModule:t,initModule:e}}(),zp.year=function(){"use strict";var t,e,n,a,o,i,r={settable_map:{set_cur_anchor:!0},set_cur_anchor:null},d={$container:null,year_list:[]},l={};return i=function(t,n){t.load("/html/zp.year.html",function(){console.log(n.year),e(t,n.year),a(n.year),l[n.year].$calendar.on("click",n,o)})},a=function(t){var e,n=0,a={year:t};for(n;12>n;n++)e=l[t].$calendar.eq(n),a.month=parseInt(e.data("month"),10),zp.calendar.initModule(e,a)},e=function(t,e){l.$container=t,l[e]={$calendar:t.find(".year-calendar")}},o=function(t){var e=$(this).data("month"),n=t.data.year,a={month:e,year:n};$.gevent.publish("month",[a])},n=function(t){zp.util.setConfigMap({input_map:t,settable_map:r.settable_map,config_map:r})},t=function(t,e){e.year=parseInt(e.year,10),d.$container=t,d.year_list[e.year]=new i(t,e)},{configModule:n,initModule:t}}();